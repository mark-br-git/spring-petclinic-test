pipeline {
    agent any

    stages {

        stage('Push to GitHub') {
            steps {
                script {
                    def githubToken = credentials('GitHub Token')
                    withCredentials([string(credentialsId: 'GitHub Token', variable: 'GITHUB_TOKEN')]) {
                 //       sh "git config --global credential.helper cache"
                  //      sh "git config --global user.email 'your.email@example.com'"
                  //      sh "git config --global user.name 'Your Name'"
                        sh "git tag 1.2.0"
                        sh "git push origin 1.2.0"
                    }
                }
            }
}

        stage('Bump Version and Create Tag') {
            steps {
                script {
                    def currentTag = sh(returnStdout: true, script: 'git describe --abbrev=0 --tags').trim()
                    def newVersion = sh(returnStdout: true, script: "python3 semver_script.py $currentTag")

                    sh "git tag $newVersion"
                    sh "git push origin $newVersion"
                }
            }
        }
    }
}


