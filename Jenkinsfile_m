pipeline {
    agent any
    environment {
        GITHUB_TOKEN = credentials('Githubtoken')
    }

    stages {


        stage('Bump Version and Create Tag') {

 
            steps {
                script {
                sh("git tag 1.7.0")
                sh "git push https://${GITHUB_TOKEN}@github.com/mark-br-git/spring-petclinic-test.git HEAD:main"

// withCredentials([usernamePassword(credentialsId: 'git', passwordVariable: 'GIT_PASSWORD', usernameVariable: 'GIT_USERNAME')]) {
//    sh("git tag 1.4.0")
//    sh('git push https://mark-br-git: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@github.com/mark-br-git/spring-petclinic-test.git 1.4.0')
// }


//def repoUrlWithAuth = "https://mark-br-git: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@github.com/mark-br-git/spring-petclinic-test.git"
//def sourceBranch = "main"

//git push --repo=${repoUrlWithAuth} --set-upstream ${repoUrlWithAuth} ${sourceBranch}

 //     def githubToken = credentials('GitHub Token')
 //     withCredentials([usernamePassword(credentialsId: 'git', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD')]) 
                
  //                  def currentTag = sh(returnStdout: true, script: 'git describe --abbrev=0 --tags').trim()
    //                def newVersion = sh(returnStdout: true, script: "python3 semver_script.py $currentTag")
   
       //             sh "git tag $newVersion"
                //    sh "git push origin $newVersion -u mark-br-git -p $PASSWORD"
                //    sh "git push https://${githubToken}@github.com/mark-br-git/spring-petclinic-test.git 1.2.0 main"
        //           sh "git push https://${githubToken}@github.com/mark-br-git/spring-petclinic-test.git main"

                    }
                }
            }
        }
    }




